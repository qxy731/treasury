<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="modelDef">

    <resultMap id="modelDefMap" class="com.soule.app.pfm.tm.model.po.ModelDefPo">
		<result property="modelCode" column="MODEL_CODE"/>
		<result property="modelName" column="MDOEL_NAME"/>
		<result property="tarCode" column="TAR_CODE"/>
		<result property="relTarCode" column="REL_TAR_CODE"/>
		<result property="tarSortCode" column="TAR_SORT_CODE"/>
		<result property="modelStatus" column="MODEL_STATUS"/>
		<result property="modelDesc" column="MDOEL_DESC"/>
		<result property="createOrg" column="CREATE_ORG"/>
		<result property="createTime" column="CREATE_TIME"/>
		<result property="lastUpdUser" column="LAST_UPD_USER"/>
		<result property="lastUpdOrg" column="LAST_UPD_ORG"/>
		<result property="lastUpdTime" column="LAST_UPD_TIME"/>
		
	</resultMap>
	
	 <!-- 根据日期、指标代码、员工代码查询表中是否有当前记录 -->
	 <select id="getModelDef" parameterClass="java.util.Map" resultMap="modelDefMap">
		 SELECT
		 	MODEL_CODE,
		 	MODEL_NAME,
		 	MODEL_STAUTS,
		 	MODEL_DESC,
		 	CREATE_USER,
		 	CREATE_ORG,
		 	CREATE_TIME,
		 	LAST_UPD_USER,
		 	LAST_UPD_ORG,
		 	LAST_UPD_TIME
		FROM
			PFM_TM_MODEL_DEF  S
			where 1=1
			<isNotEmpty prepend=" AND " property="modelCode">s.MODEL_CODE = #modelCode#</isNotEmpty>
			<isNotEmpty prepend=" AND " property="modelName">s.MODEL_NAME '%$modelName$%'</isNotEmpty>
			<isNotEmpty prepend=" AND " property="modelStatus">s.MODEL_STATUS =#modelStatus#</isNotEmpty>
			<isNotEmpty prepend=" AND " property="modelDesc">s.MODEL_DESC =#modelDesc#</isNotEmpty>
			<isNotEmpty prepend=" AND " property="createUser">s.CREATE_USER =#staff.ownerUnitid#</isNotEmpty>
			<isNotEmpty prepend=" AND " property="createOrg">s.CREATE_ORG =#staff.ownerUnitid#</isNotEmpty>
			<isNotEmpty prepend=" AND " property="createTime">s.CREATE_TIME =#staff.ownerUnitid#</isNotEmpty>
			<isNotEmpty prepend=" AND " property="lastUpdUser">s.LAST_UPD_USER =#staff.ownerUnitid#</isNotEmpty>
			<isNotEmpty prepend=" AND " property="lastUpdOrg">s.LAST_UPD_ORG =#staff.ownerUnitid#</isNotEmpty>
			<isNotEmpty prepend=" AND " property="lastUpdTime">s.LAST_UPD_TIME =#staff.ownerUnitid#</isNotEmpty>
			order by model_code
	</select>
	
	
	<delete id="delMdoelDef" parameterClass="java.util.Map">
		update pfm_tm_mdoel_Def set mode_statsu ='0' where model_code =#modelCode#
	</delete>
	
	
	<delete id="delMdoelTar" parameterClass="java.util.Map">
		delete from pfm_tm_mdoel_tar  where model_code =#modelCode# and Tar_code =#tarCode#
	</delete>
	
	
	<update id="updateModelDef" parameterClass="com.soule.app.pfm.tm.model.po.ModelDefPo">
		update pfm_tm_mdoel_Def 
		<dynamic prepend="set">
			<isNotNull prepend="," property="modelCode">MODEL_CODE = #modelCode#</isNotNull>
			<isNotNull prepend="," property="modelName">MODEL_NAME = #modelName#</isNotNull>
			<isNotNull prepend="," property="modelStatus">MODEL_STATUS = #modelStatus#</isNotNull>
			<isNotNull prepend="," property="moedlDesc">MODEL_DESC = #moedlDesc#</isNotNull>
			<isNotNull prepend="," property="createUser">CREATE_USER = #createUser#</isNotNull>
			<isNotNull prepend="," property="createOrg">CREATE_ORG = #createOrg#</isNotNull>
			<isNotNull prepend="," property="createTime">CREATE_TIME = #createTime#</isNotNull>
			<isNotNull prepend="," property="lastUpdUser">LAST_UPD_USER = #lastUpdUser#</isNotNull>
			<isNotNull prepend="," property="lastUpdOrg">LAST_UPD_ORG = #lastUpdOrg#</isNotNull>
			<isNotNull prepend="," property="lastUpdTime">LAST_UPD_TIME = #lastUpdTime#</isNotNull>
			
		</dynamic>
	</update>
	
	<insert id="insertModelDef"  parameterClass="com.soule.app.pfm.tm.model.po.ModelDefPo">
		insert into pfm_tm_mdoel_Def (model_code,model_name,model_status,model_desc,create_user,create_org,create_time)
		values(#modelCode:VARCHAR#,#modelName:VARCHAR#,#modelStatus:VARCHAR#,#modelDesc:VARCHAR#,#createUser:VARCHAR#,#createUser:VARCHAR#,#createTime:timestamp#)
	</insert>
	
	
	<insert id="insertModelTar"  parameterClass="com.soule.app.pfm.tm.model.po.ModelDefPo">
		insert into pfm_tm_mdoel_tar (model_code,tar_code,rel_tar_code,tar_sort_code)
		values(#modelCode:VARCHAR#,#tarCode:VARCHAR#,#relTarCode:VARCHAR#,#tarSortCode:VARCHAR#)
	</insert>
	
	<select id="getModelTar" paramterClass="java.util.Map" resultMap="modelDefMap">
		select model_code, TAR_CODE,REL_TAR_CODE,TAR_SORT_CODE 
		FROM PFM_TM_MODEL_DEF
		WHERE MODEl_CODE =#modelCode# 
	</select>
	
</sqlMap>